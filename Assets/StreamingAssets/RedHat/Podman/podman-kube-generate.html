<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>podman-kube-generate 1</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
</head>
<body>
<h2 id="name">NAME</h2>
<p>podman-kube-generate - Generate Kubernetes YAML based on containers,
pods or volumes</p>
<h2 id="synopsis">SYNOPSIS</h2>
<p><strong>podman kube generate</strong> [<em>options</em>]
<em>container...</em> | <em>pod...</em> | <em>volume...</em></p>
<h2 id="description">DESCRIPTION</h2>
<p><strong>podman kube generate</strong> generates Kubernetes YAML (v1
specification) from Podman containers, pods or volumes. Regardless of
whether the input is for containers or pods, Podman generates the
specification as a Pod by default. The input may be in the form of one
or more containers, pods or volumes names or IDs.</p>
<p><code>Podman Containers or Pods</code></p>
<p>Volumes appear in the generated YAML according to two different
volume types. Bind-mounted volumes become <em>hostPath</em> volume types
and named volumes become <em>persistentVolumeClaim</em> volume types.
Generated <em>hostPath</em> volume types are one of three subtypes
depending on the state of the host path: <em>DirectoryOrCreate</em> when
no file or directory exists at the host, <em>Directory</em> when host
path is a directory, or <em>File</em> when host path is a file. The
value for <em>claimName</em> for a <em>persistentVolumeClaim</em> is the
name of the named volume registered in Podman.</p>
<p>Potential name conflicts between volumes are avoided by using a
standard naming scheme for each volume type. The <em>hostPath</em>
volume types are named according to the path on the host machine,
replacing forward slashes with hyphens less any leading and trailing
forward slashes. The special case of the filesystem root,
<code>/</code>, translates to the name <code>root</code>. Additionally,
the name is suffixed with <code>-host</code> to avoid naming conflicts
with <em>persistentVolumeClaim</em> volumes. Each
<em>persistentVolumeClaim</em> volume type uses the name of its
associated named volume suffixed with <code>-pvc</code>.</p>
<p>Note that if an init container is created with type <code>once</code>
and the pod has been started, it does not show up in the generated kube
YAML as <code>once</code> type init containers are deleted after they
are run. If the pod has only been created and not started, it is in the
generated kube YAML. Init containers created with type
<code>always</code> are always generated in the kube YAML as they are
never deleted, even after running to completion.</p>
<p><em>Note</em>: When using volumes and generating a Kubernetes YAML
for an unprivileged and rootless podman container on an <strong>SELinux
enabled system</strong>, one of the following options must be completed:
* Add the "privileged: true" option to the pod spec * Add
<code>type: spc_t</code> under the <code>securityContext</code>
<code>seLinuxOptions</code> in the pod spec * Relabel the volume via the
CLI command
<code>chcon -t container_file_t -R &lt;directory&gt;</code></p>
<p>Once completed, the correct permissions are in place to access the
volume when the pod/container is created in a Kubernetes cluster.</p>
<p>Note that the generated Kubernetes YAML file can be used to re-run
the deployment via podman-play-kube(1).</p>
<p>Note that if the pod being generated was created with the
<strong>--infra-name</strong> flag set, then the generated kube yaml
will have the <strong>io.podman.annotations.infra.name</strong> set
where the value is the name of the infra container set by the user.</p>
<p>Note that both Deployment and DaemonSet can only have
<code>restartPolicy</code> set to <code>Always</code>.</p>
<p>Note that Job can only have <code>restartPolicy</code> set to
<code>OnFailure</code> or <code>Never</code>. By default, podman sets it
to <code>Never</code> when generating a kube yaml using
<code>kube generate</code>.</p>
<h2 id="options">OPTIONS</h2>
<h4 id="filename--ffilename"><strong>--filename</strong>,
<strong>-f</strong>=<em>filename</em></h4>
<p>Output to the given file instead of STDOUT. If the file already
exists, <code>kube generate</code> refuses to replace it and returns an
error.</p>
<h4 id="podman-only"><strong>--podman-only</strong></h4>
<p>Add podman-only reserved annotations in generated YAML file (Cannot
be used by Kubernetes)</p>
<h4 id="replicas--rreplica-count"><strong>--replicas</strong>,
<strong>-r</strong>=<em>replica count</em></h4>
<p>The value to set <code>replicas</code> to when generating a
<strong>Deployment</strong> kind. Note: this can only be set with the
option <code>--type=deployment</code>.</p>
<h4 id="service--s"><strong>--service</strong>, <strong>-s</strong></h4>
<p>Generate a Kubernetes service object in addition to the Pods. Used to
generate a Service specification for the corresponding Pod output. In
particular, if the object has portmap bindings, the service
specification includes a NodePort declaration to expose the service. A
random port is assigned by Podman in the specification.</p>
<h4 id="type--tpod-deployment-daemonset-job"><strong>--type</strong>,
<strong>-t</strong>=<em>pod</em> | <em>deployment</em> |
<em>daemonset</em> | <em>job</em></h4>
<p>The Kubernetes kind to generate in the YAML file. Currently, the only
supported Kubernetes specifications are <code>Pod</code>,
<code>Deployment</code>, <code>Job</code>, and <code>DaemonSet</code>.
By default, the <code>Pod</code> specification is generated.</p>
<h2 id="examples">EXAMPLES</h2>
<p>Create Kubernetes Pod YAML for the specified container.</p>
<pre><code>$ podman kube generate some-mariadb
# Save the output of this file and use kubectl create -f to import
# it into Kubernetes.
#
# Created with podman-4.8.2

# NOTE: If you generated this yaml from an unprivileged and rootless podman container on an SELinux
# enabled system, check the podman generate kube man page for steps to follow to ensure that your pod/container
# has the right permissions to access the volumes added.
---
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: &quot;2024-01-09T02:24:55Z&quot;
  labels:
    app: some-mariadb-pod
  name: some-mariadb-pod
spec:
  containers:
  - args:
    - mariadbd
    env:
    - name: MARIADB_ROOT_PASSWORD
      value: x
    image: docker.io/library/mariadb:10.11
    name: some-mariadb
    ports:
    - containerPort: 3306
      hostPort: 34891
    volumeMounts:
    - mountPath: /var/lib/mysql
      name: mariadb_data-pvc
  volumes:
  - name: mariadb_data-pvc
    persistentVolumeClaim:
      claimName: mariadb_data</code></pre>
<p>Create Kubernetes Deployment YAML with 3 replicas for the specified
container.</p>
<pre><code>$ podman kube generate --type deployment --replicas 3 dep-ct
r
# Save the output of this file and use kubectl create -f to import
# it into Kubernetes.
#
# Created with podman-4.5.0-dev
apiVersion: apps/v1
kind: Deployment
metadata:
  creationTimestamp: &quot;2023-03-27T20:45:08Z&quot;
  labels:
    app: dep-ctr-pod
  name: dep-ctr-pod-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: dep-ctr-pod
  template:
    metadata:
      annotations:
        io.podman.annotations.ulimit: nofile=524288:524288,nproc=127332:127332
      creationTimestamp: &quot;2023-03-27T20:45:08Z&quot;
      labels:
        app: dep-ctr-pod
      name: dep-ctr-pod
    spec:
      containers:
      - command:
        - top
        image: docker.io/library/alpine:latest
        name: dep-ctr</code></pre>
<p>Create Kubernetes Pod YAML for the specified container with the host
directory <code>/home/user/my-data</code> bind-mounted onto the
container path <code>/volume</code>.</p>
<pre><code>$ podman kube generate my-container-with-bind-mounted-data
# Save the output of this file and use kubectl create -f to import
# it into Kubernetes.
#
# Created with podman-3.1.0-dev
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: &quot;2021-03-18T16:26:08Z&quot;
  labels:
    app: my-container-with-bind-mounted-data
  name: my-container-with-bind-mounted-data
spec:
  containers:
  - command:
    - /bin/sh
    image: docker.io/library/alpine:latest
    name: test-bind-mount
    volumeMounts:
    - mountPath: /volume
      name: home-user-my-data-host
  restartPolicy: Never
  volumes:
  - hostPath:
      path: /home/user/my-data
      type: Directory
    name: home-user-my-data-host</code></pre>
<p>Create Kubernetes Pod YAML for the specified container with named
volume <code>priceless-data</code> mounted onto the container path
<code>/volume</code>.</p>
<pre><code>$ podman kube generate my-container-using-priceless-data
# Save the output of this file and use kubectl create -f to import
# it into Kubernetes.
#
# Created with podman-3.1.0-dev
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: &quot;2021-03-18T16:26:08Z&quot;
  labels:
    app: my-container-using-priceless-data
  name: my-container-using-priceless-data
spec:
  containers:
  - command:
    - /bin/sh
    image: docker.io/library/alpine:latest
    name: test-bind-mount
    volumeMounts:
    - mountPath: /volume
      name: priceless-data-pvc
  restartPolicy: Never
  volumes:
  - name: priceless-data-pvc
    persistentVolumeClaim:
      claimName: priceless-data</code></pre>
<p>Create Kubernetes Pod YAML for the specified pod and include a
service.</p>
<pre><code>$ sudo podman kube generate -s demoweb
# Save the output of this file and use kubectl create -f to import
# it into Kubernetes.
#
# Created with podman-0.12.2-dev
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: 2018-12-18T15:16:06Z
  labels:
    app: demoweb
  name: demoweb-libpod
spec:
  containers:
  - command:
    - python3
    - /root/code/graph.py
    image: quay.io/baude/demoweb:latest
    name: practicalarchimedes
    tty: true
    workingDir: /root/code
---
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: 2018-12-18T15:16:06Z
  labels:
    app: demoweb
  name: demoweb-libpod
spec:
  ports:
  - name: &quot;8050&quot;
    nodePort: 31269
    port: 8050
    targetPort: 0
  selector:
    app: demoweb
  type: NodePort
status:
  loadBalancer: {}</code></pre>
<h2 id="see-also">SEE ALSO</h2>
<p><strong><a href="podman.html">podman(1)</a></strong>, <strong><a
href="podman-container.html">podman-container(1)</a></strong>,
<strong><a href="podman-pod.html">podman-pod(1)</a></strong>, <strong><a
href="podman-kube-play.html">podman-kube-play(1)</a></strong>,
<strong><a
href="podman-kube-down.html">podman-kube-down(1)</a></strong></p>
<h2 id="history">HISTORY</h2>
<p>December 2018, Originally compiled by Brent Baude (bbaude at redhat
dot com)</p>
</body>
</html>
